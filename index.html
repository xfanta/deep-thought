<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Hlubina MyÅ¡lenÃ­â„¢</title>

<!-- Cache control meta tagy -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<link rel="manifest" href="manifest.json">
<link rel="stylesheet" href="style.css">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="Hlubina MyÅ¡lenÃ­">
<meta name="theme-color" content="#000000">
</head>
<body>
<script>
// Anti-cache timestamp pro vÅ¡echny soubory
const timestamp = new Date().getTime();

// PÅ™idÃ¡me timestamp k CSS
const cssLink = document.querySelector('link[rel="stylesheet"]');
if (cssLink) {
  cssLink.href = `style.css?v=${timestamp}`;
}

// NaÄtenÃ­ konfigurace s timestamp
try {
  const configScript = document.createElement('script');
  configScript.src = `config.js?v=${timestamp}`;
  configScript.onerror = () => {
    console.log('âš ï¸ Config.js nebyl nalezen - pouÅ¾ije se ruÄnÃ­ zadÃ¡nÃ­ API klÃ­Äe');
  };
  document.head.appendChild(configScript);
} catch (e) {
  console.log('âš ï¸ Konfigurace se nepodaÅ™ila naÄÃ­st');
}

// NaÄtenÃ­ hlavnÃ­ho JS s timestamp
const scriptElement = document.createElement('script');
scriptElement.src = `script-simple.js?v=${timestamp}`;
document.head.appendChild(scriptElement);

// NaÄtenÃ­ zprÃ¡v z hlubiny
async function loadMessagesFromDepth() {
  const container = document.getElementById('messagesFromDepth');
  
  try {
    const response = await fetch('/api/messages');
    const result = await response.json();
    
    if (result.success && result.messages.length > 0) {
      container.innerHTML = result.messages.map(msg => `
        <div class="message-item">
          <div class="message-timestamp">[${msg.created}]</div>
          <div>${msg.message}</div>
        </div>
      `).join('');
    } else {
      container.innerHTML = '<div class="no-messages">Å½Ã¡dnÃ© zprÃ¡vy z hlubiny nenalezeny.</div>';
    }
  } catch (error) {
    // Fallback pro lokÃ¡lnÃ­ development
    container.innerHTML = `
      <div class="message-item">
        <div class="message-timestamp">[${new Date().toLocaleString('cs-CZ')}]</div>
        <div>ğŸ”§ SystÃ©m zprÃ¡v z hlubiny je momentÃ¡lnÄ› offline. Pro plnou funkcionalnost nasaÄte na Vercel.</div>
      </div>
    `;
    console.log('API nedostupnÃ©, zobrazuji fallback zprÃ¡vu');
  }
}

// NaÄteme zprÃ¡vy po naÄtenÃ­ strÃ¡nky
setTimeout(loadMessagesFromDepth, 1000);

// Obnovujeme zprÃ¡vy kaÅ¾dÃ½ch 30 sekund
setInterval(loadMessagesFromDepth, 30000);
</script>
  <div class="container">
    <div class="uptime">UPTIME: 7,500,000 years</div>
    
    <h1>HLUBINA MYÅ LENÃâ„¢</h1>
    
    <div class="subtitle">THE ULTIMATE QUESTION ANSWERING SYSTEM</div>
    <div class="subtitle">SINCE 7.5 MILLION YEARS AGO</div>
    
    <div class="boot-messages">
      <div class="boot-line" style="animation-delay: 1s;">[SPOUÅ TÄšNÃ...]</div>
      <div class="boot-line" style="animation-delay: 1.5s;">[INICIALIZACE MYÅ LENKOVÃCH MATIC...]</div>
      <div class="boot-line" style="animation-delay: 2s;">[NAÄŒÃTÃNÃ MODULÅ® HLUBOKÃ‰HO POZNÃNÃ...]</div>
      <div class="boot-line" style="animation-delay: 2.5s;">[PÅ˜ÃPRAVA ODPOVÄšDÃ...]</div>
      <div class="boot-line warning" style="animation-delay: 3s;">[VAROVÃNÃ] ZÃ¡soby sÃ½ra jsou nÃ­zkÃ©.</div>
      <div class="boot-line info" style="animation-delay: 3.5s;">[INFO] Pohon nekoneÄnÃ© nepravdÄ›podobnosti kalibrovÃ¡n.</div>
      <div class="boot-line error" style="animation-delay: 4s;">[CHYBA] DetekovÃ¡na porucha dÃ¡vkovaÄe Äaje.</div>
      <div class="boot-line" style="animation-delay: 3.5s;">[PÅ˜IPRAVEN]</div>
    </div>

    <div class="question-prompt">POZOR!!! Pokud nenÃ­ do Hlubiny myÅ¡lenÃ­ vloÅ¾ena <b>SONDA</b>, tak vÃ½sledky jsou nezkalibrovanÃ©, zavÃ¡dÄ›jÃ­cÃ­ aÅ¾ nesmyslnÃ©.</div>
    
    <div class="question-prompt">ZPRÃVY Z HLUBINY!!!</div>
    <div id="messagesFromDepth" class="messages-container">
      <div class="loading">ğŸ“¡ NaÄÃ­tÃ¡nÃ­ zprÃ¡v z hlubiny...</div>
    </div>

    <div class="question-prompt">Zadejte otÃ¡zku, na kterou chcete znÃ¡t odpovÄ›Ä:</div>
    <div class="input-area">
      <span class="prompt-symbol">&gt;_</span>
      <button id="recordBtn">NAHRÃVAT</button>
      <span class="cursor">_</span>
    </div>
    
    <div id="outputText">[READY] SystÃ©m je pÅ™ipraven odpovÃ­dat na vaÅ¡e otÃ¡zky.</div>
    
    <div class="tip">(TIP: Pro zaÄÃ¡tek konverzace stisknÄ›te tlaÄÃ­tko NAHRÃVAT)</div>
  </div>

  <button class="hidden-reset" title="1Ã— klik: Reset konverzace | 2Ã— klik: Zobrazit historii | 3Ã— klik: Vymazat historii">[RESET]</button>

<script>
// Pokus o naÄtenÃ­ konfigurace (mÅ¯Å¾e selhat na GitHub Pages)
try {
  const configScript = document.createElement('script');
  const timestamp = new Date().getTime();
  configScript.src = `config.js?v=${timestamp}`;
  configScript.onerror = () => {
    console.log('âš ï¸ Config.js nebyl nalezen - pouÅ¾ije se ruÄnÃ­ zadÃ¡nÃ­ API klÃ­Äe');
  };
  document.head.appendChild(configScript);
} catch (e) {
  console.log('âš ï¸ Konfigurace se nepodaÅ™ila naÄÃ­st');
}
</script>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js');
}
</script>
</body>
</html>